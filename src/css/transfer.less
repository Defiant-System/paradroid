
.transfer-view {
	background: radial-gradient(ellipse at top center, #028ceb99, transparent),
				linear-gradient(180deg, #018fed, #003d92);
	border-radius: 5px;

	&:before {
		content: "";
		background: url(~/icons/circuit-board.png) 50% 50% no-repeat;
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		opacity: .125;
		border-radius: inherit;
		mix-blend-mode: soft-light;
	}

	&:after {
		content: "";
		position: absolute;
		top: 1px;
		left: 0;
		right: 0;
		height: 1px;
		background: linear-gradient(90deg, transparent 5%, rgba(#fff,.4), transparent 95%);
		pointer-events: none;
	}

	.droid {
		top: -37px;
		left: 50%;
		margin-left: -22px;
		filter: drop-shadow(0 1px 1px #0005);

		&:before {
			animation: none;
		}

		&.player {
			filter: invert(1) brightness(1.25) drop-shadow(0 1px 1px #0004);
		}
	}

	.board {
		position: absolute;
		top: 89px;
		left: 30px;
		right: 30px;
		// bottom: 31px;
		display: flex;

		.toggler {
			// background: #0001;
			position: relative;
			top: -15px;
			left: 21px;
			height: 260px;
			width: 30px;
			z-index: 2;

			&[data-active="1"] > div:nth-child(1) { display: block; }
			&[data-active="2"] > div:nth-child(2) { display: block; }
			&[data-active="3"] > div:nth-child(3) { display: block; }
			&[data-active="4"] > div:nth-child(4) { display: block; }
			&[data-active="5"] > div:nth-child(5) { display: block; }
			&[data-active="6"] > div:nth-child(6) { display: block; }
			&[data-active="7"] > div:nth-child(7) { display: block; }
			&[data-active="8"] > div:nth-child(8) { display: block; }
			&[data-active="9"] > div:nth-child(9) { display: block; }
			&[data-active="10"] > div:nth-child(10) { display: block; }
			&[data-active="11"] > div:nth-child(11) { display: block; }
			&[data-active="12"] > div:nth-child(12) { display: block; }
			&[data-active="13"] > div:nth-child(13) { display: block; }

			> div {
				display: none;
				position: absolute;
				left: 0;
				width: 14px;
				height: 14px;
				border-radius: 50%;
				cursor: pointer;

				// &:hover,
				&.active {
					display: block;
				}

				&.active {
					filter: hue-rotate(190deg) saturate(2) brightness(1.5) drop-shadow(0 0 3px #fff6);
				}

				&:before {
					content: "";
					background: url(~/icons/toggler.png) 100% 50%/contain no-repeat;
					position: absolute;
					top: -1px;
					left: -21px;
					width: 38px;
					height: 16px;
				}

				&:after {
					content: "";
					position: absolute;
					top: 2px;
					left: -21px;
					height: 10px;
					width: 13px;
					background: #2292f9;
					border-radius: 0 9px 9px 0;
				}

				&:nth-child(1) { top: 0px; }
				&:nth-child(2) { top: 22px; }
				&:nth-child(3) { top: 44px; }
				&:nth-child(4) { top: 66px; }
				&:nth-child(5) { top: 88px; }
				&:nth-child(6) { top: 110px; }
				&:nth-child(7) { top: 132px; }
				&:nth-child(8) { top: 154px; }
				&:nth-child(9) { top: 176px; }
				&:nth-child(10) { top: 198px; }
				&:nth-child(11) { top: 220px; }
				&:nth-child(12) { top: 242px; }
				&:nth-child(13) { top: 264px; }
			}
		}

		svg {
			// background: #0001;
			position: absolute;
			top: -22px;
			left: 0;
			width: 277px;
			height: 292px;
			--yellow: #fa0;
			--purple: #b761e8;

			g {
				filter: drop-shadow(0 1px 0 #0001);
				--color: #2292f9;
				--length: -64;

				.joint,
				.disconnected {
					--filter: none;
					--color: #2292f9;
				}

				&.on {
					--filter: url(#line);
					--color: var( --yellow );

					polyline { --length: -66; }
					.l66 { --length: -66; }
					.l65 { --length: -65; }

					.stream:not(.joint) {
						display: block;
						fill: none;
						stroke: #fea5;
						stroke-dashoffset: 0;
						stroke-dasharray: 6,16;
						stroke-width: 2;
						stroke-linecap: round;
						filter: url(#stream);
						animation: yellow-stream 3s infinite linear;

						&.purple { stroke: #fae8; }
					}

					.repeater {
						stroke: var( --color );
					}

					.yellow { --color: var( --yellow ); }
					.purple { --color: var( --purple ); }
				}
			}

			.stream {
				display: none;
			}

			.conn {
				filter: var( --filter );
				fill: var( --color );
				scale: 2;
				transform: translate(0px, 5px);
			}

			.start {
				filter: var( --filter );
				fill: var( --color );
				// stroke: var( --color );
				// stroke-width: 2.5;
			}

			.diode {
				filter: var( --filter );
				fill: var( --color );
				stroke: var( --color );
				stroke-width: 2.5;
			}

			.void {
				filter: var( --filter );
				fill: none;
				stroke: var( --color );
				stroke-width: 2.5;
			}

			.repeater {
				filter: var( --filter );
				fill: var( --color );
				stroke: #2292f9;
				stroke-width: 1.5;
				stroke-linejoin: round;

				&.yellow { --color: var( --yellow ); }
				&.purple { --color: var( --purple ); }
			}

			.gpu {
				filter: var( --filter );
				fill: var( --color );
			}

			.stopper {
				filter: var( --filter );
				fill: var( --color );
			}

			.chip {
				filter: var( --filter );
				fill: var( --color );
			}

			.socket {
				filter: var( --filter );
				fill: var( --color );
			}

			.line {
				filter: var( --filter );
				fill: none;
				stroke: var( --color );
				stroke-width: 2.5;
				// stroke-linejoin: round;
			}
		}

		.left,
		.right {
			position: relative;
			flex: 1;

			.side {
				position: absolute;
				top: 23px;
				bottom: 4px;
				left: 3px;
				width: 33px;
				border-radius: 7px;
				background: #322c64 linear-gradient(180deg, rgba(#fff,.15), transparent 95%);
				box-shadow: inset 0px 1px 0px 0px rgba(#888,.15),
							0 5px 7px rgba(#000,.1);

				&:after {
					content: "";
					position: absolute;
					bottom: 4px;
					left: 2px;
					right: 2px;
					height: 1px;
					background: linear-gradient(90deg, transparent 5%, rgba(#fff,.2), transparent 95%);
				}

				.led {
					position: absolute;
					top: 4px;
					left: 7px;
					right: 7px;
					bottom: 10px;
					border-radius: 3px;
					background: #f90;
					box-shadow: inset 0px 6px 0px 0px rgba(#a50,.15),
								inset 0 0 1px rgba(#940,.75),
								0 0 3px rgba(#fb3,.35),
								0 0 17px rgba(#f90,.65);

					&:before {
						content: "";
						background-image: radial-gradient(ellipse at bottom center, rgba(#fff,.15), transparent);
						position: absolute;
						top: 0;
						left: 0;
						right: 0;
						bottom: 0;
						border-radius: inherit;
					}

					&:after {
						content: "";
						position: absolute;
						bottom: 1px;
						left: 0;
						right: 0;
						height: 1px;
						background: linear-gradient(90deg, transparent 5%, rgba(#fff,.5), transparent 95%);
					}
				}

				.ammo {
					// background: rgba(#000,.1);
					position: absolute;
					top: 13px;
					left: -29px;

					> div {
						position: relative;
						width: 11px;
						height: 10px;
						margin-bottom: 11px;
						background: #2292f9;
						border-radius: 0 3px 3px 0;

						&:before {
							content: "";
							background: url(~/icons/toggler.png) 100% 50%/contain no-repeat;
							position: absolute;
							top: -1px;
							left: -1px;
							width: 27px;
							height: 12px;
						}
					}
				}
			}

			.io {
				position: absolute;
				top: 55px;
				left: 36px;
				right: -4px;
			}
		}
		
		.right {
			.toggler {
				left: 234px;

				> div {
					// background: #f003;
					transform: rotate(180deg);
					left: -3px;

					&:after {
						width: 12px;
					}

					&.active {
						filter: hue-rotate(55deg) saturate(1.5) brightness(1.2) drop-shadow(0 0 3px #fff4);
					}
				}
			}

			.side {
				left: auto;
				right: 3px;

				.led {
					background: #b4f;
					box-shadow: 0 -1px 0 rgba(#111,.15),
								inset 0px 6px 0px 0px rgba(#50a,.15),
								inset 0 0 1px rgba(#408,.95),
								0 0 2px #9c0fd877,
								0 0 7px rgba(#b4f,.5);
				}

				.ammo {
					left: auto;
					right: -29px;

					> div {
						transform: rotate(180deg);
					}
				}
			}
				
			.io {
				top: 54px;
				left: -4px;
				right: 42px;

				svg {
					left: -11px;

					g {
						--length: -67;

						&.on {
							--color: var( --purple );

							polyline { --length: -65; }

							.stream {
								stroke: #fae8;
								animation-name: purple-stream;

								&.yellow { stroke: #fea5; }
							}
						}
					}

					.conn {
						transform: translate(139px, 21px) rotate(180deg);
					}
				}
			}
		}
		
		.center {
			position: relative;
			width: 90px;
			display: flex;
			flex-direction: column;

			> div {
				position: relative;
				background: #3c357a linear-gradient(180deg, rgba(#fff,.15), transparent);
				border-radius: 9px;
				box-shadow: inset 0px 1px 0px 0px rgba(#888,.15),
							0 5px 7px rgba(#000,.1);

				// &:before {
				// 	content: "";
				// 	background-image: radial-gradient(ellipse at top center, rgba(#fff,.25), transparent);
				// 	position: absolute;
				// 	top: 0;
				// 	left: 0;
				// 	right: 0;
				// 	bottom: 0;
				// 	border-radius: inherit;
				// }

				&:after {
					content: "";
					position: absolute;
					bottom: 4px;
					left: 0;
					right: 0;
					height: 1px;
					background: linear-gradient(90deg, transparent 5%, rgba(#fff,.25), transparent 95%);
				}
			}

			.cpu {
				top: -47px;
				height: 53px;

				&:before {
					content: "";
					position: absolute;
					top: 11px;
					left: -41px;
					width: 171px;
					height: 85px;
					background: url(~/icons/cpu-circuit.png) 50% 50%/contain no-repeat;
				}

				&[data-winner="deadlock"] {
					.led {
						background: #999;
						box-shadow: inset 0px 6px 0px 0px rgba(#666,.15),
									inset 0 0 1px rgba(#888,.95),
									0 0 3px #888,
									0 0 17px rgba(#999,.85);

						&:before {
							opacity: .4;
						}
					}
				}

				&[data-winner="yellow"] {
					.led {
						background: #f90;
						box-shadow: inset 0px 6px 0px 0px rgba(#a50,.15),
									inset 0 0 1px rgba(#940,.95),
									0 0 3px #fb3,
									0 0 17px rgba(#f90,.85);
					}
				}

				&[data-winner="purple"] {
					.led {
						background: #b4f;
						box-shadow: inset 0px 6px 0px 0px rgba(#50a,.15),
									inset 0 0 1px rgba(#408,.95),
									0 0 3px #9c0fd8,
									0 0 17px rgba(#b4f,.85);

						&:before {
							opacity: .4;
						}

						&:after {
							opacity: .75;
						}
					}
				}

				.led {
					position: relative;
					top: 5px;
					left: 8px;
					width: 74px;
					height: 41px;
					background: #f90;
					border-radius: 5px;
					box-shadow: inset 0px 6px 0px 0px rgba(#a50,.15),
								inset 0 0 1px rgba(#940,.95),
								0 0 3px #fb3,
								0 0 17px rgba(#f90,.85);

					&:before {
						content: "";
						background-image: radial-gradient(ellipse at bottom center, rgba(#fff,.5), transparent);
						position: absolute;
						top: 0;
						left: 0;
						right: 0;
						bottom: 0;
						border-radius: inherit;
					}

					&:after {
						content: "";
						position: absolute;
						bottom: 2px;
						left: 0;
						right: 0;
						height: 1px;
						background: linear-gradient(90deg, transparent 5%, rgba(#fff,.5), transparent 95%);
					}
				}

				b {
					position: absolute;
					background: #369fff;
					box-shadow: none;

					&[data-i="1"] {
						top: 14px;
						left: -9px;
						width: 9px;
						height: 9px;
						border-radius: 3px 0 0 3px;
					}

					&[data-i="2"] {
						top: 30px;
						left: -9px;
						width: 9px;
						height: 9px;
						border-radius: 3px 0 0 3px;
					}

					&[data-i="3"] {
						bottom: -9px;
						left: 10px;
						width: 9px;
						height: 9px;
						border-radius: 0 0 3px 3px;
					}

					&[data-i="4"] {
						bottom: -9px;
						left: 25px;
						width: 9px;
						height: 9px;
						border-radius: 0 0 3px 3px;
					}

					&[data-i="5"] {
						bottom: -9px;
						left: 40px;
						width: 9px;
						height: 9px;
						border-radius: 0 0 3px 3px;
					}

					&[data-i="6"] {
						bottom: -9px;
						left: 55px;
						width: 9px;
						height: 9px;
						border-radius: 0 0 3px 3px;
					}

					&[data-i="7"] {
						bottom: -9px;
						left: 70px;
						width: 9px;
						height: 9px;
						border-radius: 0 0 3px 3px;
					}

					&[data-i="8"] {
						top: 30px;
						right: -9px;
						width: 9px;
						height: 9px;
						border-radius: 0 3px 3px 0;
					}

					&[data-i="9"] {
						top: 14px;
						right: -9px;
						width: 9px;
						height: 9px;
						border-radius: 0 3px 3px 0;
					}
				}
			}

			.io-leds {
				top: -4px;
				left: 15px;
				flex: 1;
				padding: 9px 7px;
				width: 60px;

				div {
					position: relative;
					height: 19px;
					border-radius: 4px;
					margin-bottom: 3px;

					&:before,
					&:after {
						content: "";
						position: absolute;
						bottom: 1px;
						left: 0;
						right: 0;
						height: 1px;
						background: linear-gradient(90deg, transparent 5%, rgba(#fff,.35), transparent 95%);
					}

					&:after {
						bottom: -1px;
					}

					&.yellow {
						background: #fb4;
						box-shadow: 0 -1px 0 rgba(#111,.15),
									inset 0px 5px 0px 0px rgba(#a50,.15),
									inset 0 0 1px rgba(#940,.95),
									0 0 2px #fb3,
									0 0 7px rgba(#fb4,.5);
					}
					
					&.purple {
						background: #b4f;
						box-shadow: 0 -1px 0 rgba(#111,.15),
									inset 0px 5px 0px 0px rgba(#50a,.15),
									inset 0 0 1px rgba(#408,.95),
									0 0 2px #9c0fd877,
									0 0 7px rgba(#b4f,.5);
					}
				}
			}
		}
	}
}

@keyframes yellow-stream {
	to { stroke-dashoffset: var( --length ); }
}

@keyframes purple-stream {
	from { stroke-dashoffset: var( --length ); }
}
